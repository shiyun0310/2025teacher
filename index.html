<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥‡ç¾é†«å­¸ä¸­å¿ƒ 114 å¹´åº¦é™¢ç´šå„ªè‰¯æ•™å¸«åå–® ğŸ†</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- å¼•å…¥ SweetAlert2 ç”¨æ–¼æ¼‚äº®çš„æŸ¥è©¢çµæœå½ˆçª— -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: linear-gradient(180deg, #f0f9ff 0%, #dbeafe 100%);
            background-attachment: fixed;
            color: #334155;
            min-height: 100vh;
        }

        .glass-nav {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        .modern-card {
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.7);
            overflow: hidden;
            transition: all 0.3s ease;
            margin-bottom: 24px;
        }
        .modern-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.08), 0 4px 6px -2px rgba(0, 0, 0, 0.04);
            border-color: #cbd5e1;
            transform: translateY(-2px);
        }

        .blob {
            position: fixed;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.5;
            animation: float 10s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(20px, -20px); }
        }

        .accordion-content {
            transition: max-height 0.3s ease-in-out, opacity 0.3s ease-in-out;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }
        .accordion-content.expanded {
            max-height: 5000px;
            opacity: 1;
        }
        
        .chevron-icon {
            transition: transform 0.3s ease;
        }
        .chevron-icon.rotated {
            transform: rotate(180deg);
        }

        .btn-loading {
            position: relative;
            pointer-events: none;
            color: transparent !important;
        }
        .btn-loading::after {
            content: "";
            position: absolute;
            left: 50%;
            top: 50%;
            width: 1.25em;
            height: 1.25em;
            border: 2px solid #fff;
            border-radius: 50%;
            border-right-color: transparent;
            transform: translate(-50%, -50%);
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin {
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
    </style>
</head>
<body class="pb-20">

    <div class="blob bg-white w-96 h-96 rounded-full top-0 left-0 -translate-x-1/2 -translate-y-1/2 opacity-40"></div>
    <div class="blob bg-blue-300 w-80 h-80 rounded-full bottom-0 right-0 translate-x-1/3 translate-y-1/3 animation-delay-2000 opacity-30"></div>

    <nav class="fixed w-full z-40 glass-nav top-0">
        <div class="max-w-5xl mx-auto px-4 sm:px-6">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-3 cursor-pointer" onclick="window.scrollTo({top:0, behavior:'smooth'})">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-lg shadow-lg shadow-blue-500/30">
                        å¥‡
                    </div>
                    <h1 class="text-lg font-bold text-slate-700 tracking-tight hidden sm:block">
                        å¥‡ç¾é†«å­¸ä¸­å¿ƒ <span class="text-slate-400 font-normal">|</span> å„ªè‰¯æ•™å¸«åå–®
                    </h1>
                </div>
            </div>
        </div>
    </nav>

    <main class="pt-28 px-4 sm:px-6 max-w-5xl mx-auto">

        <div class="relative overflow-hidden bg-gradient-to-br from-slate-800 via-blue-900 to-slate-800 rounded-2xl p-8 mb-10 shadow-2xl shadow-blue-900/20 text-white animate__animated animate__fadeIn">
            <div class="absolute top-0 right-0 p-10 opacity-10">
                <i data-lucide="award" class="w-64 h-64 -mr-16 -mt-16 rotate-12"></i>
            </div>
            
            <div class="relative z-10 flex flex-col md:flex-row items-center justify-between gap-6">
                <div>
                    <h2 class="text-5xl md:text-7xl font-black mb-6 tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-amber-100 via-yellow-200 to-amber-100 drop-shadow-[0_0_15px_rgba(253,224,71,0.8)]" style="filter: drop-shadow(0 0 20px rgba(250, 204, 21, 0.6)) drop-shadow(0 4px 3px rgba(0,0,0,0.5));">
                        114å¹´åº¦å„ªè‰¯æ•™å¸«åå–®
                    </h2>
                    <p class="text-blue-200/80 text-lg max-w-xl font-light">
                        æ­å–œæ‚¨ç²é¸ç‚ºæœ¬å¹´åº¦å„ªè‰¯æ•™å¸«ï¼Œä¸¦æ„Ÿè¬æ‚¨ä»¥å°ˆæ¥­èˆ‡ç†±å¿±ï¼ŒæŒçºŒåŸ¹è‚²å„ªç§€çš„é†«å­¸äººæ‰ï¼Œå¥‡ç¾å› ç‚ºæœ‰æ‚¨ï¼Œæ‰æ›´åŠ å“è¶Šï¼
                    </p>
                </div>
                <div class="hidden md:block">
                    <span class="text-6xl">ğŸ†</span>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-2xl shadow-xl overflow-hidden mb-10 animate__animated animate__fadeInUp" style="animation-delay: 0.1s;">
            <div class="bg-purple-600 p-6 sm:p-8 relative overflow-hidden">
                <div class="absolute -top-6 -right-6 w-32 h-32 bg-purple-500 rounded-full opacity-50 flex items-center justify-center">
                    <div class="w-24 h-24 border-4 border-purple-400 rounded-full"></div>
                </div>
                
                <div class="relative z-10">
                    <h2 class="text-2xl sm:text-3xl font-bold text-white flex items-center gap-3 mb-2">
                        <span class="w-10 h-10 bg-gradient-to-br from-yellow-300 to-yellow-500 rounded-full flex items-center justify-center text-xl shadow-lg border-2 border-white/30">ğŸ¥‡</span>
                        å—çé€šçŸ¥èˆ‡å›è¦†
                    </h2>
                    <p class="text-purple-100 text-sm sm:text-base mt-2 font-medium">
                        æ•¬è«‹æŸ¥é–±ä¸‹æ–¹ç²çåå–®ï¼Œä¸¦å›è¦†æ˜¯å¦å¯å‡ºå¸­é ˜çã€‚
                    </p>
                </div>
            </div>

            <div class="p-6 sm:p-8 space-y-8">
                <div class="bg-rose-50 rounded-xl p-6 sm:p-8 border border-rose-100 relative overflow-hidden">
                    <div class="absolute -bottom-6 -right-6 pointer-events-none select-none">
                        <i data-lucide="bell-ring" class="w-48 h-48 text-rose-200 opacity-40 -rotate-12"></i>
                    </div>

                    <div class="relative z-10">
                        <h3 class="text-xl font-bold text-rose-800 mb-6 flex items-center gap-2">
                            <span class="w-8 h-8 rounded-full bg-rose-100 flex items-center justify-center border border-rose-200">
                                <i data-lucide="bell" class="w-4 h-4 text-rose-600"></i>
                            </span>
                            èª æ‘¯é‚€è«‹ç²çè€…å…±åŒå‡ºå¸­å—ç
                        </h3>
                        
                        <div class="space-y-4 text-slate-700 pl-1 sm:pl-2">
                            <div class="flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3">
                                <span class="font-bold text-slate-900 min-w-[3em]">æœƒè­°ï¼š</span>
                                <span>12æœˆä»½é†«å‹™æœƒè­°</span>
                            </div>
                            <div class="flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3">
                                <span class="font-bold text-slate-900 min-w-[3em]">æ—¥æœŸï¼š</span>
                                <span class="text-xl font-black text-rose-600 bg-white px-3 py-1 rounded-md border border-rose-200 shadow-sm">12/26 (äº”) 16:45</span>
                            </div>
                            <div class="flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3">
                                <span class="font-bold text-slate-900 min-w-[3em]">é›†åˆï¼š</span>
                                <span>ç¬¬äº”é†«ç™‚å¤§æ¨“ 5æ¨“ 552 æœƒè­°å®¤å¤–</span>
                            </div>
                            <div class="flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3">
                                <span class="font-bold text-slate-900 min-w-[3em]">å‚™è¨»ï¼š</span>
                                <span>è«‹ç©¿è‘—å·¥ä½œæœ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    <label for="awardSearch" class="block text-slate-700 font-bold text-lg">
                        è«‹è¼¸å…¥ç²çè€…äººäº‹è™Ÿï¼Œå›è¦†æ˜¯å¦èƒ½å‡ºå¸­å—ç
                    </label>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <input type="text" id="awardSearch" placeholder="è«‹è¼¸å…¥äººäº‹è™Ÿ (ä¾‹å¦‚ï¼šA12345)" 
                            class="flex-1 px-5 py-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 outline-none transition-all text-slate-700 text-lg bg-slate-50 placeholder-slate-400">
                        <button id="awardSearchBtn" class="bg-purple-600 hover:bg-purple-700 text-white font-bold px-8 py-3 rounded-lg flex items-center justify-center gap-2 transition-colors shadow-lg shadow-purple-200 min-w-[140px]">
                            <i data-lucide="search" class="w-5 h-5"></i>
                            <span>æŸ¥è©¢è³‡æ–™</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-2xl shadow-xl p-6 sm:p-8 animate__animated animate__fadeInUp" style="animation-delay: 0.2s;">
            <div class="mb-8 flex justify-between items-end border-b border-slate-100 pb-4">
                <div>
                    <h3 class="text-slate-700 font-bold text-2xl flex items-center gap-3">
                        <span class="w-8 h-8 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center">
                            <i data-lucide="list-filter" class="w-5 h-5"></i>
                        </span>
                        å„ªè‰¯æ•™å¸«åå–®ç¸½è¦½
                    </h3>
                    <p class="text-slate-400 text-sm mt-1 pl-11">æ‰€æœ‰ç²çåå–® (é»æ“Šå±•é–‹è©³ç´°å…§å®¹)</p>
                </div>
            </div>
            <div id="teachers-container" class="space-y-6"></div>
        </div>

    </main>

    <footer class="text-center py-8 text-slate-500 text-base sm:text-lg font-bold">
        <p>å¥‡ç¾é†«å­¸ä¸­å¿ƒï½œæ•™å¸«åŸ¹è‚²ä¸­å¿ƒ åˆ†æ©Ÿ52007</p>
    </footer>

    <script>
        // ============================================
        // 1. Google Apps Script API URL
        // ============================================
        const GAS_API_URL = "https://script.google.com/macros/s/AKfycbw4EZibjYX8uWBxRtfGHvy_Zg43DkjsRcdU9PUCX3naGF_zGguIVrS4M6z8-LhOF6M-/exec"; 

        // ============================================
        // 2. éœæ…‹è³‡æ–™æº
        // ============================================
        const staticTeachersData = [
            {
                category: "å‚‘å‡ºæ•™å¸«",
                colorClass: "orange", 
                icon: "crown",
                members: [
                    { name: "è¬æ˜†éœ–", dept: "æ³Œå°¿å¤–ç§‘", title: "é†«å¸«", rank: "å‚‘å‡º" },
                    { name: "é™³æ˜±å»·", dept: "å¤–ç§‘éƒ¨", title: "é†«å¸«", rank: "å‚‘å‡º" },
                    { name: "æä¿Šè‚²", dept: "ç‰™é†«éƒ¨", title: "é†«å¸«", rank: "å‚‘å‡º" },
                    { name: "å³æŸå‹³", dept: "è­·ç†éƒ¨", title: "å‰¯è­·ç†é•·", rank: "å‚‘å‡º" },
                    { name: "é»ƒè²ç‘—", dept: "è­·ç†éƒ¨", title: "å‰¯è­·ç†é•·", rank: "å‚‘å‡º" },
                    { name: "èŠä½©è¯", dept: "è­·ç†éƒ¨", title: "å°çµ„é•·", rank: "å‚‘å‡º" },
                    { name: "é™³ä¹ƒç‘—", dept: "è­·ç†éƒ¨", title: "å°çµ„é•·", rank: "å‚‘å‡º" },
                    { name: "å¾ç§‰è£•", dept: "è—¥åŠ‘éƒ¨", title: "çµ„é•·", rank: "å‚‘å‡º" },
                    { name: "é»ƒå»ºä¸­", dept: "å½±åƒé†«å­¸éƒ¨", title: "çµ„é•·", rank: "å‚‘å‡º" },
                    { name: "ç‹ä»å®", dept: "è‡¨åºŠç—…ç†éƒ¨", title: "é†«æª¢å¸«", rank: "å‚‘å‡º" }
                ]
            },
            {
                category: "ä¸»æ²»é†«å¸«çµ„ å„ªè‰¯æ•™å¸«",
                colorClass: "blue",
                icon: "stethoscope",
                members: [
                    { name: "è¬å­Ÿå€‰", dept: "è…¦ä¸­é¢¨ä¸­å¿ƒ", title: "ä¸»ä»»", rank: "å„ªè‰¯" },
                    { name: "é»ƒç­ å©·", dept: "è…è‡Ÿç§‘", title: "é†«å¸«", rank: "å„ªè‰¯" },
                    { name: "é™³ä¿Šå˜‰", dept: "æ•´å½¢å¤–ç§‘", title: "ä¸»ä»»", rank: "å„ªè‰¯" },
                    { name: "è³´å¿—æ”¿", dept: "åŠ è­·é†«å­¸éƒ¨", title: "é†«å¸«", rank: "å„ªè‰¯" },
                    { name: "é„­ç¬éœ–", dept: "ç²¾ç¥é†«å­¸ç§‘", title: "é†«å¸«", rank: "å„ªè‰¯" },
                    { name: "æ¥Šæ¸…å‚‘", dept: "æ”¾å°„è…«ç˜¤éƒ¨", title: "é†«å¸«", rank: "å„ªè‰¯" },
                    { name: "æ—è€€è°", dept: "éº»é†‰éƒ¨", title: "é†«å¸«", rank: "å„ªè‰¯" }
                ]
            },
            {
                category: "ä½é™¢é†«å¸«çµ„ å„ªè‰¯æ•™å¸«",
                colorClass: "emerald",
                icon: "graduation-cap",
                members: [
                    { name: "æŸ¯å¾·æ•", dept: "æ”¾å°„è…«ç˜¤éƒ¨", title: "é†«å¸«", rank: "å„ªè‰¯" },
                    { name: "é»ƒåšè£•", dept: "å…§ç§‘éƒ¨", title: "é†«å¸«", rank: "å„ªè‰¯" },
                    { name: "æ²ˆæšç†", dept: "ç²¾ç¥é†«å­¸éƒ¨", title: "é†«å¸«", rank: "å„ªè‰¯" },
                    { name: "å³è°ä½‘", dept: "å®¶åº­é†«å­¸éƒ¨", title: "é†«å¸«", rank: "å„ªè‰¯" },
                    { name: "é˜éŸ‹ç­‘", dept: "éº»é†‰éƒ¨", title: "é†«å¸«", rank: "å„ªè‰¯" },
                    { name: "è©¹äºˆä½³", dept: "ç‰™é†«éƒ¨", title: "é†«å¸«", rank: "å„ªè‰¯" }
                ]
            },
            {
                category: "è­·ç†çµ„ å„ªè‰¯æ•™å¸«",
                colorClass: "rose",
                icon: "heart-handshake",
                members: [
                    { name: "æ±Ÿéˆºç‘©", dept: "è­·ç†éƒ¨", title: "è­·ç†å¸«", rank: "ç¬¬ä¸€å" },
                    { name: "è˜‡è‡´ç©", dept: "è­·ç†éƒ¨", title: "å°çµ„é•·", rank: "ç¬¬ä¸€å" },
                    { name: "æŸ¯æ¬£æ…§", dept: "è­·ç†éƒ¨", title: "å°çµ„é•·", rank: "ç¬¬ä¸€å" },
                    { name: "ç‹è—è“", dept: "è­·ç†éƒ¨", title: "å°çµ„é•·", rank: "ç¬¬ä¸€å" },
                    { name: "ä¸ç¥–ç", dept: "è­·ç†éƒ¨", title: "å°çµ„é•·", rank: "ç¬¬äºŒå" },
                    { name: "é»ƒæƒ æš„", dept: "è­·ç†éƒ¨", title: "è­·ç†é•·", rank: "ç¬¬äºŒå" },
                    { name: "æ›¾ç¾çª", dept: "è­·ç†éƒ¨", title: "è­·ç†å¸«", rank: "ç¬¬äºŒå" },
                    { name: "å¼µå˜‰å¥‡", dept: "è­·ç†éƒ¨", title: "å‰¯è­·ç†é•·", rank: "ç¬¬äºŒå" },
                    { name: "æ´ªç‰ç²", dept: "è­·ç†éƒ¨", title: "å‰¯è­·ç†é•·", rank: "ç¬¬ä¸‰å" },
                    { name: "æ¥Šé›…éˆ", dept: "è­·ç†éƒ¨", title: "å°çµ„é•·", rank: "ç¬¬ä¸‰å" },
                    { name: "è¨±é™³éŸ»ç«¹", dept: "è­·ç†éƒ¨", title: "è­·ç†å¸«", rank: "ç¬¬ä¸‰å" },
                    { name: "ä¹ˆéƒå‰", dept: "è­·ç†éƒ¨", title: "å°çµ„é•·", rank: "ç¬¬ä¸‰å" },
                    { name: "é­å¦™èŠ¬", dept: "è­·ç†éƒ¨", title: "å‰¯è­·ç†é•·", rank: "å„ªè‰¯" },
                    { name: "é‚±æ¢…ç³", dept: "è­·ç†éƒ¨", title: "å°çµ„é•·", rank: "å„ªè‰¯" },
                    { name: "é»ƒæƒ çª", dept: "è­·ç†éƒ¨", title: "å°çµ„é•·", rank: "å„ªè‰¯" },
                    { name: "é„­æ®·ç”„", dept: "è­·ç†éƒ¨", title: "å°çµ„é•·", rank: "å„ªè‰¯" }
                ]
            },
            {
                category: "é†«äº‹äººå“¡çµ„ å„ªè‰¯æ•™å¸«",
                colorClass: "yellow",
                icon: "flask-conical",
                members: [
                    { name: "å‚…æŸæ†²", dept: "è—¥åŠ‘éƒ¨", title: "è—¥å¸«", rank: "å„ªè‰¯" },
                    { name: "å³ä½³è“", dept: "è—¥åŠ‘éƒ¨", title: "è—¥å¸«", rank: "å„ªè‰¯" },
                    { name: "ç‹æ”¿å‡±", dept: "è—¥åŠ‘éƒ¨", title: "è—¥å¸«", rank: "å„ªè‰¯" },
                    { name: "æ—ä½³éœ", dept: "è—¥åŠ‘éƒ¨", title: "å°çµ„é•·", rank: "å„ªè‰¯" },
                    { name: "å³å®œéœ", dept: "æ”¾å°„è…«ç˜¤éƒ¨", title: "é†«äº‹æ”¾å°„å¸«", rank: "å„ªè‰¯" },
                    { name: "ä½™è™¹", dept: "æ”¾å°„è…«ç˜¤éƒ¨", title: "é†«äº‹æ”¾å°„å¸«", rank: "å„ªè‰¯" },
                    { name: "é™³æµ©ä¸­", dept: "å½±åƒé†«å­¸éƒ¨", title: "é†«äº‹æ”¾å°„å¸«", rank: "å„ªè‰¯" },
                    { name: "ä½•èˆˆä¸­", dept: "å½±åƒé†«å­¸éƒ¨", title: "é†«äº‹æ”¾å°„å¸«", rank: "å„ªè‰¯" },
                    { name: "é™³æ…•æ½”", dept: "è‡¨åºŠç—…ç†éƒ¨", title: "ä¸­éš(I)é†«æª¢å¸«", rank: "å„ªè‰¯" },
                    { name: "æ—å®¶æ¦›", dept: "è‡¨åºŠç—…ç†éƒ¨", title: "ä¸­éš(I)é†«æª¢å¸«", rank: "å„ªè‰¯" },
                    { name: "é»ƒæ„æ¶µ", dept: "è‡¨åºŠç—…ç†éƒ¨", title: "è‡¨åºŠé†«æª¢å¸«", rank: "å„ªè‰¯" },
                    { name: "è¬ä½³å€«", dept: "è‡¨åºŠç—…ç†éƒ¨", title: "ä¸­éš(II)é†«æª¢å¸«", rank: "å„ªè‰¯" },
                    { name: "æˆ´ç´‹å›", dept: "ç‡Ÿé¤Šç§‘", title: "ç‡Ÿé¤Šå¸«", rank: "å„ªè‰¯" },
                    { name: "é«˜ä½³ç‘œ", dept: "å‘¼å¸æ²»ç™‚ç§‘", title: "å‰¯çµ„é•·", rank: "å„ªè‰¯" },
                    { name: "é„­æ¹˜é »", dept: "å‘¼å¸æ²»ç™‚ç§‘", title: "å°çµ„é•·", rank: "å„ªè‰¯" },
                    { name: "å¼µè‚²ç‘Ÿ", dept: "è€³é¼»å–‰éƒ¨", title: "è½åŠ›å¸«", rank: "å„ªè‰¯" },
                    { name: "é™³æ€¡è‡»", dept: "å¾©å¥éƒ¨ç‰©ç†æ²»ç™‚çµ„", title: "ç‰©ç†æ²»ç™‚å¸«", rank: "å„ªè‰¯" },
                    { name: "æ—è‹¡ç«¹", dept: "å¾©å¥éƒ¨ç‰©ç†æ²»ç™‚çµ„", title: "ç‰©ç†æ²»ç™‚å¸«", rank: "å„ªè‰¯" },
                    { name: "æ—æ²›æš„", dept: "å¾©å¥éƒ¨è·èƒ½æ²»ç™‚çµ„", title: "è·èƒ½æ²»ç™‚å¸«", rank: "å„ªè‰¯" },
                    { name: "ä½•è©©å›", dept: "é é˜²é†«å­¸ç§‘", title: "è‡¨åºŠå¿ƒç†å¸«", rank: "å„ªè‰¯" },
                    { name: "æ—æ˜æ€¡", dept: "å¾©å¥éƒ¨èªè¨€æ²»ç™‚çµ„", title: "èªè¨€æ²»ç™‚å¸«", rank: "å„ªè‰¯" },
                    { name: "é™³åº­æ¥·", dept: "ç¤¾æœƒæœå‹™éƒ¨ç¤¾å·¥çµ„", title: "ç¤¾æœƒå·¥ä½œå¸«", rank: "å„ªè‰¯" },
                    { name: "è‘‰æ•æ…§", dept: "å…§ç§‘å°ˆå¸«çµ„", title: "å°ˆç§‘è­·ç†å¸«", rank: "å„ªè‰¯" },
                    { name: "èŒƒå€©è¯", dept: "å…§ç§‘å°ˆå¸«çµ„", title: "å°ˆç§‘è­·ç†å¸«", rank: "å„ªè‰¯" },
                    { name: "æ—ä½³å›", dept: "å¤–ç§‘å°ˆå¸«çµ„", title: "å°ˆç§‘è­·ç†å¸«", rank: "å„ªè‰¯" },
                    { name: "ä½™ç¾è²", dept: "åŠ è­·é†«å­¸å°ˆå¸«çµ„", title: "å°ˆç§‘è­·ç†å¸«", rank: "å„ªè‰¯" }
                ]
            }
        ];

        let onlineSheetData = [];
        let isSheetLoaded = false;

        function getColorClasses(colorName) {
            const map = {
                orange: { bg: 'bg-orange-50', text: 'text-orange-600', border: 'border-orange-200', stripe: 'bg-orange-500', hover: 'hover:bg-orange-50/80', cardBg: 'bg-orange-50/60', cardBorder: 'border-orange-200' },
                blue: { bg: 'bg-blue-50', text: 'text-blue-600', border: 'border-blue-200', stripe: 'bg-blue-500', hover: 'hover:bg-blue-50/80', cardBg: 'bg-blue-50/60', cardBorder: 'border-blue-200' },
                emerald: { bg: 'bg-emerald-50', text: 'text-emerald-600', border: 'border-emerald-200', stripe: 'bg-emerald-500', hover: 'hover:bg-emerald-50/80', cardBg: 'bg-emerald-50/60', cardBorder: 'border-emerald-200' },
                rose: { bg: 'bg-rose-50', text: 'text-rose-600', border: 'border-rose-200', stripe: 'bg-rose-500', hover: 'hover:bg-rose-50/80', cardBg: 'bg-rose-50/60', cardBorder: 'border-rose-200' },
                indigo: { bg: 'bg-indigo-50', text: 'text-indigo-600', border: 'border-indigo-200', stripe: 'bg-indigo-500', hover: 'hover:bg-indigo-50/80', cardBg: 'bg-indigo-50/60', cardBorder: 'border-indigo-200' },
                yellow: { bg: 'bg-yellow-50', text: 'text-yellow-700', border: 'border-yellow-200', stripe: 'bg-yellow-500', hover: 'hover:bg-yellow-50/80', cardBg: 'bg-yellow-50/60', cardBorder: 'border-yellow-200' }
            };
            return map[colorName] || map.blue;
        }

        function renderTeachers(filterText = "") {
            const container = document.getElementById('teachers-container');
            container.innerHTML = "";
            
            const isSearching = filterText.length > 0;

            staticTeachersData.forEach((section, index) => {
                const filteredMembers = section.members.filter(m => 
                    m.name.includes(filterText) || 
                    m.dept.includes(filterText) ||
                    section.category.includes(filterText)
                );

                if (filteredMembers.length > 0) {
                    const colors = getColorClasses(section.colorClass);
                    const expandClass = isSearching ? "expanded" : ""; 
                    const rotateClass = isSearching ? "rotated" : ""; 

                    const card = document.createElement('div');
                    card.className = "modern-card animate__animated animate__fadeInUp";
                    card.style.animationDelay = `${index * 0.1}s`;

                    const headerHtml = `
                        <div onclick="toggleSection(${index})" class="cursor-pointer px-6 py-5 ${colors.bg} border-b ${colors.border} flex items-center justify-between gap-2 relative group transition-colors ${colors.hover}">
                            <div class="absolute left-0 top-0 bottom-0 w-1.5 ${colors.stripe}"></div>
                            <div class="flex items-center gap-3 pl-2 flex-1">
                                <div class="p-2 bg-white rounded-lg shadow-sm text-gray-600">
                                    <i data-lucide="${section.icon}" class="w-5 h-5"></i>
                                </div>
                                <div class="flex items-center">
                                    <h3 class="text-xl font-bold ${colors.text} tracking-tight">${section.category}</h3>
                                </div>
                            </div>
                            <div class="flex items-center gap-4">
                                <span class="hidden sm:inline-flex items-center px-3 py-1 bg-white/60 rounded-full text-xs font-semibold text-slate-500 border border-slate-200/50 shadow-sm">
                                    å…± ${filteredMembers.length} ä½
                                </span>
                                <i id="icon-${index}" data-lucide="chevron-down" class="w-5 h-5 text-slate-400 chevron-icon ${rotateClass}"></i>
                            </div>
                        </div>
                    `;

                    const listContainer = document.createElement('div');
                    listContainer.id = `content-${index}`;
                    listContainer.className = `accordion-content ${expandClass}`; 
                    
                    const innerList = document.createElement('div');
                    innerList.className = "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 p-4 bg-white";
                    
                    filteredMembers.forEach(member => {
                        const item = document.createElement('div');
                        item.className = `relative flex flex-col p-4 aspect-auto sm:aspect-[3/1] min-h-[100px] justify-center rounded-xl border-[1.5px] transition-transform duration-200 hover:-translate-y-0.5 hover:shadow-lg ${colors.cardBg} ${colors.cardBorder}`;
                        
                        let rankTag = "";
                        if (member.rank.includes("ç¬¬ä¸€å")) {
                             rankTag = `<div class="absolute top-2 right-2"><span class="text-[10px] font-bold text-yellow-700 bg-yellow-100 px-2 py-0.5 rounded border border-yellow-300 flex items-center gap-1 shadow-sm"><i data-lucide="trophy" class="w-3 h-3 text-yellow-600"></i>${member.rank}</span></div>`;
                        } else if (member.rank.includes("ç¬¬äºŒå")) {
                             rankTag = `<div class="absolute top-2 right-2"><span class="text-[10px] font-bold text-slate-600 bg-slate-100 px-2 py-0.5 rounded border border-slate-300 flex items-center gap-1 shadow-sm"><i data-lucide="medal" class="w-3 h-3 text-slate-500"></i>${member.rank}</span></div>`;
                        } else if (member.rank.includes("ç¬¬ä¸‰å")) {
                             rankTag = `<div class="absolute top-2 right-2"><span class="text-[10px] font-bold text-orange-800 bg-orange-100 px-2 py-0.5 rounded border border-orange-300 flex items-center gap-1 shadow-sm"><i data-lucide="medal" class="w-3 h-3 text-orange-700"></i>${member.rank}</span></div>`;
                        }

                        item.innerHTML = `
                            ${rankTag}
                            <div class="text-base font-bold text-slate-500 mb-1 truncate">
                                ${member.dept}
                            </div>
                            <div class="flex items-end gap-2 w-full overflow-hidden">
                                <h4 class="text-xl sm:text-2xl font-bold text-slate-700 leading-none truncate min-w-0">
                                    ${member.name}
                                </h4>
                                <span class="text-sm font-medium text-slate-400 shrink-0 mb-0.5">
                                    ${member.title}
                                </span>
                            </div>
                        `;
                        innerList.appendChild(item);
                    });

                    listContainer.appendChild(innerList);
                    card.innerHTML = headerHtml;
                    card.appendChild(listContainer);
                    container.appendChild(card);
                }
            });
            
            lucide.createIcons();
        }

        async function fetchSheetData() {
            try {
                const nocacheUrl = GAS_API_URL + '?t=' + new Date().getTime();
                const response = await fetch(nocacheUrl);
                if (!response.ok) throw new Error('Network response was not ok');
                const data = await response.json();
                if (data.error) throw new Error(data.error);

                onlineSheetData = data;
                isSheetLoaded = true;
                console.log("Sheet è³‡æ–™è¼‰å…¥å®Œæˆ (æœ€æ–°)ï¼Œå…± " + data.length + " é¡åˆ¥");
            } catch (error) {
                console.error("Sheet è³‡æ–™è¼‰å…¥å¤±æ•—:", error);
            }
        }

        async function sendResponseToSheet(id, status) {
            const response = await fetch(GAS_API_URL, {
                method: 'POST',
                body: JSON.stringify({ id: id, status: status })
            });
            const result = await response.json();
            return result;
        }

        function showSubmissionModal(member, category) {
            Swal.fire({
                title: `<span class="text-2xl font-bold text-slate-800">ğŸ‰ æ­å–œæ‚¨ï¼</span>`,
                html: `
                    <div class="text-left bg-purple-50 p-4 rounded-xl border border-purple-100 mb-4">
                        <p class="text-sm text-purple-600 font-bold mb-1">ç²çé …ç›®</p>
                        <p class="text-lg font-bold text-slate-800 mb-3">${category}</p>
                        
                        <div class="grid grid-cols-2 gap-2">
                            <div>
                                <p class="text-xs text-slate-500">å–®ä½</p>
                                <p class="font-medium">${member.dept}</p>
                            </div>
                            <div>
                                <p class="text-xs text-slate-500">å§“å</p>
                                <p class="font-medium text-lg">${member.name}</p>
                            </div>
                        </div>
                    </div>
                    <p class="text-slate-600 mb-4">è¬¹è¨‚æ–¼ 12/26(äº”)16:45 æ–¼ 552 æœƒè­°å®¤è¾¦ç†å—çäº‹å®œï¼Œ<br>æ•¬è«‹æ’¥å†—å‡ºå¸­é ˜çï¼</p>
                `,
                icon: 'success',
                
                showConfirmButton: true,
                confirmButtonText: 'æ”¶åˆ°ï¼Œæˆ‘æœƒå‡ºå¸­é ˜ç',
                confirmButtonColor: '#9333ea',
                
                showDenyButton: true,
                denyButtonText: 'æŠ±æ­‰ï¼Œä¸å…‹å‡ºå¸­é ˜ç',
                denyButtonColor: '#64748b',
                
                showCancelButton: false,
                
                showLoaderOnConfirm: true,
                showLoaderOnDeny: true,
                
                preConfirm: async () => {
                    try {
                        const res = await sendResponseToSheet(member.id, "å‡ºå¸­é ˜ç");
                        if (!res.success) throw new Error(res.message);
                        return res;
                    } catch (error) {
                        Swal.showValidationMessage(`å¯«å…¥å¤±æ•—: ${error}`);
                    }
                },

                preDeny: async () => {
                    try {
                        const res = await sendResponseToSheet(member.id, "ä¸å…‹å‡ºå¸­");
                        if (!res.success) throw new Error(res.message);
                        return res;
                    } catch (error) {
                        Swal.showValidationMessage(`å¯«å…¥å¤±æ•—: ${error}`);
                        return false;
                    }
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire({
                        icon: 'success',
                        title: '',
                        text: 'å·²æ”¶åˆ°æ‚¨çš„å›è¦†ï¼Œè¬è¬',
                        confirmButtonColor: '#9333ea'
                    });
                } else if (result.isDenied) {
                    Swal.fire({
                        icon: 'success', // Changed to success icon (checkmark)
                        title: '',
                        text: 'å·²æ”¶åˆ°æ‚¨çš„å›è¦†ï¼Œè¬è¬',
                        confirmButtonColor: '#64748b'
                    });
                }
            });
        }

        async function triggerAwardSearch() {
            const searchInput = document.getElementById('awardSearch');
            const searchBtn = document.getElementById('awardSearchBtn');
            const query = searchInput.value.trim().toUpperCase();

            if (!query) {
                Swal.fire({
                    icon: 'warning',
                    title: 'è«‹è¼¸å…¥è³‡æ–™',
                    text: 'è«‹è¼¸å…¥äººäº‹è™Ÿæˆ–å§“åé€²è¡ŒæŸ¥è©¢',
                    confirmButtonColor: '#9333ea'
                });
                return;
            }

            searchBtn.classList.add('btn-loading');

            await fetchSheetData();

            let foundMember = null;
            let foundCategory = "";

            for (const categoryData of onlineSheetData) {
                const member = categoryData.members.find(m => 
                    (m.id && m.id.toUpperCase() === query) || 
                    (m.name === query)
                );
                
                if (member) {
                    foundMember = member;
                    foundCategory = categoryData.category;
                    break;
                }
            }

            searchBtn.classList.remove('btn-loading');

            if (foundMember) {
                if (foundMember.responseStatus) {
                    let displayTime = foundMember.responseTime || '';
                    if (displayTime && (displayTime.includes('GMT') || displayTime.length > 20)) {
                        try {
                            const date = new Date(displayTime);
                            if (!isNaN(date.getTime())) {
                                const pad = (n) => n.toString().padStart(2, '0');
                                displayTime = `${pad(date.getMonth() + 1)}/${pad(date.getDate())} ${pad(date.getHours())}:${pad(date.getMinutes())}`;
                            }
                        } catch (e) {}
                    }

                    Swal.fire({
                        title: 'æ‚¨å·²å®Œæˆå›è¦†',
                        html: `
                            <div class="text-left bg-blue-50 p-4 rounded-xl border border-blue-100 mb-4">
                                <p class="text-gray-600 mb-2">æ‚¨å·²æ–¼ <span class="font-mono text-gray-800">${displayTime}</span> å›è¦†ï¼š</p>
                                <p class="text-xl font-bold text-blue-700 text-center py-2 bg-white rounded-lg shadow-sm border border-blue-100">
                                    ${foundMember.responseStatus}
                                </p>
                            </div>
                        `,
                        icon: 'info',
                        showCancelButton: false,
                        confirmButtonText: 'é—œé–‰',
                        confirmButtonColor: '#64748b'
                    });
                } else {
                    showSubmissionModal(foundMember, foundCategory);
                }
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'æŸ¥ç„¡è³‡æ–™',
                    text: 'ç³»çµ±æ‰¾ä¸åˆ°æ­¤äººäº‹è™Ÿæˆ–å§“åï¼Œè«‹ç¢ºèªè¼¸å…¥æ˜¯å¦æ­£ç¢ºã€‚',
                    confirmButtonColor: '#64748b'
                });
            }
        }

        window.toggleSection = function(index) {
            const content = document.getElementById(`content-${index}`);
            const icon = document.getElementById(`icon-${index}`);
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                icon.classList.remove('rotated');
            } else {
                content.classList.add('expanded');
                icon.classList.add('rotated');
            }
        };

        renderTeachers(); 
        fetchSheetData();

        document.getElementById('awardSearchBtn').addEventListener('click', triggerAwardSearch);
        document.getElementById('awardSearch').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') triggerAwardSearch();
        });

    </script>
</body>
</html>
